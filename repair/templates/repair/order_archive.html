{% extends "repair/base.html" %}
{% load staticfiles %}

{% block top_menu %}
  {% include "includes/top_menu.html" %}
{% endblock %}


{% block sidebar_action %}
{% endblock %}

{% block sub_header_progress_bar %}
    <h2 class="sub-header">Ремонты - Архивные заказы</h2>
{% endblock %}


{% block table_main %}
{% load bootstrap3 %}

<div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Фильтр заказов</h3>
      </div>
      <div class="panel-body">
        <form class="form" action="" method="get" autocomplete="off" id="filter_form">
            {%bootstrap_field daterange_widget_form.period placeholder='----------' form_group_class='form-group col-md-4'%}
            {% bootstrap_form filter.form bound_css_class='' form_group_class='form-group col-md-4'%}
            <div class="col-md-8">
              {% buttons %}
                <button type="submit" class="btn btn-primary">
                  {% bootstrap_icon "search" %} Фильтровать
                </button>
                <button id="get_all" type="button" class="btn btn-info" value="all">
                   {% bootstrap_icon "th" %} Показать все записи
                </button>
              {% endbuttons %}
            </div>
        </form>
      </div>
    </div>
</div>

<div class="col-md-12">
  <div class="table-responsive">
    <table class="table table-hover table-striped tablesorter" id="table">
      <thead>
        <th><span class="glyphicon glyphicon-barcode"></span></th>
        <th>Дата приемки</th>
        <th>Статус</th>
        {% if not outsource %}<th>Клиент</th>{% endif %}
        <th>Устройство</th>
        <th>Серийный номер</th>
        <th class="hidden-xs">Заявленная неисправность</th>
        <th>Мастер</th>
      </thead>
      <tfoot>
        <th><input type="text" placeholder="Search"/></th>
        <th><input type="text" placeholder="Search"/></th>
        <th><input type="text" placeholder="Search"/></th>
        {% if not outsource %}
        <th><input type="text" placeholder="Search"/></th>
        {% endif %}
        <th></th>
        <th></th>
        <th class="hidden-xs"></th>
        <th><input type="text" placeholder="Search"/></th>
      </tfoot>

      {% for order in object_list %}
      <tr>
        <td><a href="{% url 'repair:order_detail' order_id=order.id %}"><span class="badge">{{ order.order_barcode }}</span></a></td>
        <td>{{ order.order_datetime|date:"d.m.Y" }}</td>
        {% with order.last_status as last_act %}
          <td>{% include "includes/order_status.html" %}</td>
        {% endwith %}
        {% if not outsource %}<td>{{ order.client.client_name }}</td>{% endif %}
        <td>{{ order.device_name }}</td>
        <td>{{ order.device_serial }}</td>
        <td class="hidden-xs">{{ order.device_defect }}</td>
        <td>{{ order.last_action.executor_user.get_full_name }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
</div>
{% endblock %}


{% block script_block %}
  <script type="text/javascript" src="{% static 'repair/js/moment.min.js' %}" defer></script>
  <script type="text/javascript" src="{% static 'repair/js/daterangepicker.js' %}" defer></script>
  <link rel="stylesheet" type="text/css" href="{% static 'repair/css/daterangepicker.css'%}">
  <link href="{% static 'repair/css/jquery.dataTables.min.css' %}" rel="stylesheet">
  <script type="text/javascript" src="{% static 'repair/js/tab_sort.js' %}"></script>
  <script type="text/javascript" src="{% static 'repair/js/jquery.dataTables.min.js' %}"></script>
{% endblock %}
