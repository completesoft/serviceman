{% extends "repair/base.html" %}
{% load staticfiles %}

{% block other_css %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock %}


{% block top_menu %}
  {% include "includes/top_menu.html" %}
{% endblock %}


{% block sidebar_action %}
{% if not outsource %}
  {% include "includes/action_menu.html" with menu_set="b" %}
{% endif %}
{% endblock %}


{% block sub_header_progress_bar %}
  {% if messages %}
    {% for message in messages %}
      <p>
        <div class="alert alert alert-success alert-dismissable">
          <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
          {{ message }}
        </div>
      </p>
    {% endfor %}
  {% endif %}
  <h2 class="sub-header">База картриджей</h2>
{% endblock %}


{% block table_main %}
  <div class="table-responsive">
    <table class="table table-hover table-striped" id="table">
      <thead>
        <th><span class="glyphicon glyphicon-barcode"></span></th>
        <th>Дата регистрации в БД</th>
        <th>Модель</th>
        <th>Серийный номер</th>
        {% if not outsource %}
        <th>Клиент</th>
        <th>Размещение</th>
        {% endif %}
      </thead>
      <tfoot>
        <th><input type="text" placeholder="Search"/></th>
        <th><input type="text" placeholder="Search"/></th>
        <th><input type="text" placeholder="Search"/></th>
        <th><input type="text" placeholder="Search"/></th>
        {% if not outsource %}
        <th><input type="text" placeholder="Search"/></th>
        <th><input type="text" placeholder="Search"/></th>
        {% endif %}
      </tfoot>

      {% for cartridge in cartridges %}
      <tr>
        <td><span class="badge">{{ cartridge.id }}</span></td>
        <td>{{ cartridge.add_datetime|date:"d.m.Y" }}</td>
        <td>{{ cartridge.model }}</td>
        <td>{{ cartridge.serial_number }}</td>
          {%if not outsource %}
            <td>{{ cartridge.client.client_name }}</td>
            <td>
              <div class="input-group">
                <input type="text" class="form-control position" readonly dupm="{{ cartridge.client_position }}" value="{{ cartridge.client_position }}">
                <span class="input-group-btn">
                  <button class="btn btn-default upd-location" title="Обновить" type="button" cartridge="{{ cartridge.id }}"><i class="fa fa-refresh"></i></button>
                </span>
              </div>
            </td>
          {% endif %}
      </tr>
      {% endfor %}
    </table>
  </div>
{% endblock %}


{% block script_block %}
  <link href="{% static 'repair/css/jquery.dataTables.min.css' %}" rel="stylesheet">
  <script type="text/javascript" src="{% static 'repair/js/jquery.dataTables.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'repair/js/cartridges_location_update.js' %}"></script>
{% endblock %}