{% extends "repair/base.html" %}
{% load staticfiles %}

{% block sidebar_navigation %}
  <h4 class="list-group-item-heading">Навигация:</h4>
  <ul class="nav nav-sidebar">
    <li><a href="{% url 'repair:index' %}"><span class="glyphicon glyphicon-search"></span> Обзор</a></li>
    <li><a href="#"><span class="glyphicon glyphicon-usd"></span> Начисления</a></li>
  </ul>
{% endblock %}

{% block sidebar_thesaurus %}
  <h4 class="list-group-item-heading">Справочники:</h4>
  <ul class="nav nav-sidebar">
    <li><a href=""><span class="glyphicon glyphicon-user"></span> Клиенты</a></li>
    <li><a href=""><span class="glyphicon glyphicon-wrench"></span> Виды работ</a></li>
  </ul>
{% endblock %}

{% block sidebar_action %}
  <h4 class="list-group-item-heading">Действуем:</h4>
  <ul class="nav nav-sidebar">
    <li><a href="{% url 'repair:order_add' %}"><span class="glyphicon glyphicon-plus"></span> Добавить заказ</a></li>
  </ul>
{% endblock %}


{% block sub_header_progress_bar %}
    <div class="panel panel-info">
        <div class="panel-heading">
            <h3 class="panel-title">Текущие данные заказа</h3>
        </div>
        <div class="panel-body">
            <div class="col-sm-3 col-md-3">
                Штрихкод: {{ order.order_barcode }}
            </div>
            <div class="col-sm-3 col-md-3">
                Последнее изменение: {{ order.last_action.action_datetime|date:"d.m.Y" }}
            </div>
            <div class="col-sm-3 col-md-3">
                {% with order.last_status as last_act %}
                Текущий статус:
                    {% if last_act == "Новый" %}
                      <span class="label label-default">{{ last_act }}</span>
                    {% elif last_act == "В работе" %}
                      <span class="label label-primary">{{ last_act }}</span>
                    {% elif last_act == "Ожидание" %}
                      <span class="label label-warning">{{ last_act }}</span>
                    {% elif last_act == "Выполнен" %}
                      <span class="label label-success">{{ last_act }}</span>
                    {% elif last_act == "Просрочен" %}
                      <span class="label label-danger">{{ last_act }}</span>
                    {% else %}
                      <span class="label label-danger">НЕТ СТАТУСА</span>
                    {% endif %}
                  {% endwith %}
            </div>
            <div class="col-sm-3 col-md-3">
                Текущий исполнитель: {{ order.last_action.executor_user.get_full_name }}
            </div>
        </div>
    </div>
  <h2 class="sub-header">Выполненные работы:</h2>
{% endblock %}




{% block table_main %}
{% load bootstrap3 %}
<form action="" method="post" autocomplete="off">
    {% csrf_token %}
    {{service_formset.management_form }}
    <div class="panel panel-primary">
        <div class="panel-heading"><h4>Выполненные работы</h4></div>
        <div class="panel-body">
            <div id="service_div">
                {% for form in service_formset %}
                    <fieldset id="service_block">
                        {{ form.as_p }}
                        <hr />
                    </fieldset>
                {% endfor %}
            </div>
            <input id="add_service" type="button" class="btn btn-info" value="Добавить работ" />
            <input id="del_service" type="button" class="btn btn-danger" value="Убрать работ" />
        </div>
    </div>
    <input type="submit" class="btn btn-info" id="sub_button" value="Отправить"/>
</form>


{% endblock %}
